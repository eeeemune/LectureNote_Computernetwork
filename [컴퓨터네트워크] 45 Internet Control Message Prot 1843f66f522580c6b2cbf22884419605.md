# [ì»´í“¨í„°ë„¤íŠ¸ì›Œí¬] 45. Internet Control Message Protocol (ICMP)

<aside>

# ğŸ’– Internet Control Message Protocol (ICMP)

</aside>

<aside>

**ê°œë…ì ìœ¼ë¡œ ì¤‘ìš”í•œ ê±´ ë§ì§€ë§Œ ë””í…Œì¼í•œ ë¶€ë¶„ì„ ë‹¤ ì™¸ìš¸ í•„ìš”ê°€ ì—†ë‹¤ê³  í•˜ì‹¬. ì¡´ì¬ì™€ ì—­í• ë§Œ íŒŒì•…í•˜ë©´ ëœë‹¤ê³  í•˜ì‹¬**

</aside>

## ICMP

ì•ì„œ ìš°ë¦¬ëŠ” TTLì´ 0ì´ ë˜ë©´ ê·¸ packetì„ ë²„ë¦¬ê³  í•´ë‹¹ ì‚¬ì‹¤ì„ hostì—ê²Œ ì•Œë ¤ ì¤€ë‹¤ê³  ë°°ì› ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë°, ì´ë ‡ê²Œ routerì—ì„œ errorê°€ ë°œìƒí–ˆì„ ë•Œ í•´ë‹¹ ì‚¬ì‹¤ì„ hostì—ê²Œ ì–´ë–»ê²Œ ì•Œë ¤ì¤„ ìˆ˜ ìˆëŠ” ê±¸ê¹Œìš”? ì´ ë•Œ **hostì™€ routerê°€ network layerì—ì„œ í†µì‹ í•˜ëŠ” ë°©ì‹**ì´ ICMP(Internet Communication Message Protocol)ì…ë‹ˆë‹¤.

## ICMPì˜ format

### ê¸°ë³¸ ë©”ì‹œì§€ í¬ë§·

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2045%20Internet%20Control%20Message%20Prot%201843f66f522580c6b2cbf22884419605/image.png)

### ICMPì˜ datafield

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2045%20Internet%20Control%20Message%20Prot%201843f66f522580c6b2cbf22884419605/image%201.png)

ìœ„ì™€ ê°™ì´ í—¤ë”ì™€ 8byteì˜ data fieldê°€ ìˆìŠµë‹ˆë‹¤.

## ICMP message types

<aside>

**ì•„ë˜ ë§ê³ ëŠ” ë””í…Œì¼í•œ ë¶€ë¶„ì„ íŒŒì•…í•  í•„ìš”ëŠ” ì—†ë‹¤ê³  í•˜ì‹¬**

</aside>

### âš¡ Time Exceeded

ì‹œê°„ ì´ˆê³¼. TTL ê°’ì´ ëª¨ë‘ ì†Œì§„ë˜ì—ˆë‹¤ëŠ” ì •ë³´ì…ë‹ˆë‹¤.

### âš¡ ICMP redirect message

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2045%20Internet%20Control%20Message%20Prot%201843f66f522580c6b2cbf22884419605/image%202.png)

Hostë¡œ í•˜ì—¬ê¸ˆ **ë‹¤ìŒë¶€í„°ëŠ” ìì‹ ì´ ì•„ë‹ˆë¼ ë‹¤ë¥¸ routerë¡œ ìì‹ ì˜ packetì„ ë³´ë‚´ë„ë¡**í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

- ì˜ˆë¥¼ ë“¤ì–´, HostAê°€ router R1ìœ¼ë¡œ packetì„ ë³´ëƒˆë‹¤ê³  í•©ì‹œë‹¤.
- ì´ ìƒí™©ì—ì„œ, R1ì—ì„œëŠ” í•´ë‹¹ packetì´ ìì‹ ì´ ì•„ë‹ˆë¼ R2ë¡œ ê°€ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  íŒë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ ë•Œ packetì´ R1ì„ ê±°ì³ì„œ R2ë¡œ ê°€ëŠ” ê²ƒë³´ë‹¤ëŠ” Aì—ì„œ ë°”ë¡œ R2ë¡œ ë³´ë‚´ëŠ” ê²ƒì´ íš¨ìœ¨ì ì¼ ê²ƒì…ë‹ˆë‹¤.
- ìœ„ì™€ ê°™ì€ ìƒí™©ì—ì„œ **ë‹¤ìŒë¶€í„°ëŠ” ìì‹ ì´ ì•„ë‹ˆë¼ ë‹¤ë¥¸ routerë¡œ í•´ë‹¹ packetì„ ë³´ë‚´ë„ë¡ messageë¥¼ ì „ë‹¬**í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

### âš¡ Traceroute

ICMPì˜ í™œìš©ì…ë‹ˆë‹¤. ICMPë¥¼ í™œìš©í•˜ë©´ ì–´ë–¤ networkì˜ ë‚´ë¶€ êµ¬ì¡°ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. direct deliveryë¡œ ë³´ë‚¼ ìˆ˜ ìˆëŠ” routerë“¤ì„ ëª¨ë‘ ì¶œë ¥í•©ë‹ˆë‹¤.

### Stopping criteria

- UDP segmentë¥¼ ë³´ëƒ„
- destinationì´ `port unrecheable` messageë¥¼ ë³´ëƒ„
- ê·¸ëŸ¬ë©´ sourceê°€ stopí•¨
- ë§Œì•½ ICMP messageê°€ sourceì— ë„ì°©í–ˆì„ ë•Œ, RTTê°’ì„ ê¸°ë¡í•´ ë‘ 