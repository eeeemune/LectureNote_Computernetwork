# [ì»´í“¨í„°ë„¤íŠ¸ì›Œí¬] 47. HTTP

<aside>

# ğŸ’– HTTPì™€ Web

</aside>

## HTTP ê°œìš”

### serverì™€ client

ì „í˜•ì ì¸ server-client ëª¨ë¸ì„ ë”°ë¦…ë‹ˆë‹¤.

- **clientëŠ” ìš”ì²­ì„ ë³´ë‚´ê³  web objectë¥¼ display**í•©ë‹ˆë‹¤.
- serverëŠ” requestë¥¼ ë°›ê³  web objectë¥¼ ë³´ëƒ…ë‹ˆë‹¤.

### HTTPì˜ layer

**TCP layer**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

- ë”°ë¼ì„œ serverì˜ portë²ˆí˜¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 80ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

### stateless

- HTTP í†µì‹ ì„ í•˜ëŠ” serverëŠ” **statelessí•œ ìƒíƒœ**ë¥¼ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.
    - ì§ì „ì— **clientê°€ ì–´ë–¤ ìš”ì²­ì„ ë³´ëƒˆëŠ”ì§€ì— ê´€ê³„ ì—†ì´ í•­ìƒ ê°™ì€ ë™ì‘**ì„ í•´ì•¼ í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

<aside>

# ğŸ’– Persistent HTTP

</aside>

## HTTPì˜ ë‘ê°€ì§€ ì¢…ë¥˜

1. Non-persistent HTTP
2. Persistent HTTP

## âš¡ Non-persistent HTTP

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image.png)

í•˜ë‚˜ì˜ TCP ì—°ê²°ì„ í†µí•´ì„œëŠ” **ìµœëŒ€ í•œ ê°œì˜ object**ë§Œ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ë”°ë¼ì„œ 100ê°œì˜ objectë¥¼ ë°›ì•„ì•¼ í•œë‹¤ë©´ 100ê°œì˜ TCP ì—°ê²°ì„ ìˆ˜ë¦½í•´ì•¼ í•©ë‹ˆë‹¤.
- ìµœì´ˆì˜ HTTPëŠ” ì´ëŸ¬í•œ í˜•íƒœë¥¼ ì·¨í–ˆìŠµë‹ˆë‹¤.

### Non-persistent HTTP ë™ì‘

<aside>

1. TCP connection opened
2. **at most one object** sent over TCP connection
3. **TCP connection closed**
</aside>

## âš¡ Persistent HTTP(HTTP/1.1)

### Persistent HTTPì˜ ë“±ì¥ ë°°ê²½

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%201.png)

<aside>

(Response Time) = 2RTT+ file transmission time

</aside>

ìœ„ì˜ ê·¸ë¦¼ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯, HTTP í†µì‹ ì—ì„œ **ì‹¤ì œ file transsmissionì„ ìœ„í•´ í•„ìš”í•œ ì‹œê°„ì€ ì–¼ë§ˆ ë˜ì§€ ì•Šì§€ë§Œ** fileì„ requestí•˜ê³  receiveí•˜ëŠ” ì‹œê°„ì´ í›¨ì”¬ ë§ì´ ë“¤ê²Œ ë©ë‹ˆë‹¤.

- ë”°ë¼ì„œ **request í•˜ë‚˜ì— objectí•˜ë‚˜ë§Œ ë°›ëŠ” non persistent HTTP ë°©ì‹ì€ ë¹„íš¨ìœ¨ì **ì…ë‹ˆë‹¤.

### Persistent HTTP

í•˜ë‚˜ì˜ TCP ì—°ê²°ì„ í†µí•´ì„œ ì—¬ëŸ¬ objectsë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•©ë‹ˆë‹¤.

<aside>

1. TCP connection opened
2. multiple objects can be sent over single TCP connection between client, and that server
3. TCP connection closed
</aside>

- ì¥ì 
    - TCP ì—°ê²°ì— ì˜í•œ overheadë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë‹¨ì 
    - ë§Œì•½ Persistent HTTPì—ì„œ objectë¥¼ ë°›ì€ í›„ì— ì—°ê²°ì„ ê³„ì† ì•ˆ ëŠê³  ìˆë‹¤ë©´?
    - ì´ ê²½ìš° **ì„œë²„ ì…ì¥ì—ì„œëŠ” socket ì—°ê²°ì„ ê³„ì† ìœ ì§€í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— momory ê³µê°„ì„ ë‚­ë¹„**í•˜ê²Œ ë©ë‹ˆë‹¤.

### Persistent HTTP with pipelining

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%202.png)

- HTTPëŠ” TCP layer ê¸°ë°˜ì´ë¯€ë¡œ, ìš°ë¦¬ê°€ **sliding window**ì—ì„œ ë°°ìš´ ê²ƒì²˜ëŸ¼ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•´ë„ ë  ê²ƒì…ë‹ˆë‹¤.
    - responseê°€ ì˜¤ê¸° ì „ì—ë„ requestë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.
- ì´ëŸ¬í•œ ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<aside>

# ğŸ’– HTTP request message

</aside>

## Reuest message header

```cpp
GET /index.html HTTP/1.1\r\n //request line

//header lines
Host: www-net.cs.umass.edu\r\n
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X
10.15; rv:80.0) Gecko/20100101 Firefox/80.0 \r\n
Accept: text/html,application/xhtml+xml\r\n
Accept-Language: en-us,en;q=0.5\r\n
Accept-Encoding: gzip,deflate\r\n
Connection: keep-alive\r\n
\r\n
```

### âš¡ Host

```cpp
Host: www-net.cs.umass.edu\r\n
```

server hostëŠ” virtual hostë¥¼ ìš´ì˜í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

- í•˜ë‚˜ì˜ serverì—ì„œ ì—¬ëŸ¬ ê°œì˜ hostê°€ ìš´ì˜ë  ìˆ˜ë„ ìˆë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.
- ì´ ë•Œ **ë‚´ê°€ ì–´ë–¤ hostë¥¼ ëª©í‘œë¡œ ì˜¨ ê±´ì§€**ë¥¼ ëª…ì‹œí•´ ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.
- ë”°ë¼ì„œ í•´ë‹¹ ì •ë³´ë¥¼ ì ì–´ ë‘¡ë‹ˆë‹¤.

### âš¡ User-Agent

```cpp
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:80.0) Gecko/20100101 Firefox/80.0 \r\n
```

clientê°€ ì§€ê¸ˆ ì–´ë–¤ ì¢…ë¥˜ì˜ web browserë¥¼ ì“°ê³  ìˆëŠ”ì§€ë¥¼ ì¶”ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í˜„ì¬ì—ëŠ” ëª¨ì¢…ì˜ ì´ìœ ë¡œâ€¦ ì—¬ëŸ¬ web browserë“¤ì„ í•œ ë²ˆì— ì ëŠ”ë‹¤ê³  í•©ë‹ˆë‹¤.

### âš¡ Accept-Encoding

```cpp
Accept: text/html,application/xhtml+xml\r\n
Accept-Language: en-us,en;q=0.5\r\n
Accept-Encoding: gzip,deflate\r\n
```

ì–´ë–¤ í˜•íƒœë¡œ, ì–´ë–¤ ì–¸ì–´ë¡œ, ë˜ ì–´ë–¤ encoding ë°©ì‹ìœ¼ë¡œ responseë¥¼ ë°›ê³  ì‹¶ì€ì§€ë¥¼ ê¸°ì…í•´ ë‘¡ë‹ˆë‹¤.

### âš¡ Connection

```cpp
Connection: keep-alive\r\n
```

persistentì¸ì§€ non-persistentì¸ì§€ë¥¼ ì ì–´ ë‘¡ë‹ˆë‹¤.

- keep-alive: persistent HTTP

## Request message format

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%203.png)

<aside>

# ğŸ’– HTTP response message

</aside>

## response message ì˜ˆì‹œ

```cpp
//status line
HTTP/1.1 200 OK
//header lines
Date: Tue, 08 Sep 2020 00:53:20 GMT
Server: Apache/2.4.6 (CentOS)
OpenSSL/1.0.2k-fips PHP/7.4.9
mod_perl/2.0.11 Perl/v5.16.3
Last-Modified: Tue, 01 Mar 2016 18:57:50 GMT
ETag: "a5b-52d015789ee9e"
Accept-Ranges: bytes
Content-Length: 2651
Content-Type: text/html; charset=UTF-8
\r\n
data data data data data ... 
```

## response status codes

- 200 OK
- 404 Not Found
- 301 moved permanently
- 400 bad request
- â€¦

<aside>

# ğŸ’– Cookies

</aside>

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%204.png)

serverì™€ clientê°€ ì–´ë– í•œ ê°’ì„ ê³µìœ í•©ë‹ˆë‹¤. ê·¸ë˜ì„œ ë‹¤ìŒ ì—°ê²° ì‹œ headerì— í•´ë‹¹ ê°’ì´ ì í˜€ ìˆë‹¤ë©´ ì˜ˆì „ì— ë°©ë¬¸í–ˆë˜ ì ì´ ìˆëŠ” broswerì„ì„ ì•Œì•„ì±Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì´ëŸ¬í•œ ë°©ì‹ì„ í†µí•´ì„œ **statelessë¥¼ ìœ ì§€**í•˜ë©´ì„œë„ ë” íš¨ìœ¨ì ìœ¼ë¡œ interactionì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì˜ˆì‹œ

### tracking a userâ€™s browsing behavior

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%205.png)

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%206.png)

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2047%20HTTP%201843f66f522580eba899f04c1f24a22c/image%207.png)