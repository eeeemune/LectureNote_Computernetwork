# [컴퓨터네트워크] 42. Netword Address Translation (NAT)

<aside>

# 💖 Network Address Translation

</aside>

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2042%20Netword%20Address%20Translation%20(%201843f66f522580248cabd5cd834e663f/image.png)

## 필요한 배경

- 사설 주소는 router에서 자신에게 속해있는 host들에게 임의로 부여한 주소입니다.
    - 따라서 이 주소는 globally unique하지 않습니다.
- 그래서 해당 주소를 unique하게 translation해줘야 하는데, 이 때 필요한 것이  `NAT`(Network Address Translation)입니다.

## 변환 방식

![image.png](%5B%E1%84%8F%E1%85%A5%E1%86%B7%E1%84%91%E1%85%B2%E1%84%90%E1%85%A5%E1%84%82%E1%85%A6%E1%84%90%E1%85%B3%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%5D%2042%20Netword%20Address%20Translation%20(%201843f66f522580248cabd5cd834e663f/image%201.png)

- 사설망 내의 네트워크가 router를 통해 외부망에 접근할 때, 해당 router를 담당하는 하나의 주소를 이용할 수 있습니다.
- 사설망 내부의 네트워크들을 public 주소로 바꿨을 때는 모두 같은 IP 주소를 사용하고, port 번호를 이용해 구분합니다.
- 하지만, 이 상황이라면 10.0.0.1, 10.0.0.2… 등의 사설 네트워크가 모두 같은 주소를 사용해야만 할 것입니다.
- 이 때 해결법은 **포트 번호까지 사용**하는 것입니다.

<aside>

**사설망 내부에서 같은 port 번호를 사용할 경우에는 어떻게 되나요?**

LAN side에서는 이미 주소가 다르기 때문에 문제가 없습니다. WAN side로 변환할 때, 각 주소에 서로 다른 port번호를 할당해 줍니다.

</aside>

## NAT 방식의 장단점

<aside>

**시험에 장단점 부분을 한 문제 정도는 낼 수 있도록 노력하겠다고… 말씀하심**

</aside>

### 장점

- 전체 관점에서, **주소를 재사용**할 수 있습니다.
- 사용자 입장에서, **주소를 하나만 사면 되기 때문에 비용을 절약**할 수 있습니다.
- 보안적인 관점에서, **내부가 어떻게 되어있는지를 외부로부터 숨길 수 있습니다.**

### 단점

- **port번호는 4계층**인데, **IP 주소는 3계층**입니다.
    - router는 layer3에서 전송됩니다.
    - port번호는 layer4에서 할당됩니다.
    - 따라서 NAT 방식은 layering을 파괴하는… 방식입니다.
- 사설망 내부의 주소 개수는 한정되어 있습니다.
    - port번호는 16bit로 이루어져 있습니다.
    - 따라서 NAT를 적용할 수 있는 주소 또한 2^16개로 주소가 한정될 수밖에 없습니다.

<aside>

**NAT traversal 부분은 관심 있으면 찾아 보라고 말씀하심**

</aside>